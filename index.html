<!-- Agregar esto antes del cierre del body -->
<script>
// Configuración de la API
const API_ENDPOINT = 'https://api.romannumeralconverter.com/api/v1';
const USE_API = true; // Cambiar a false para usar solo la lógica local

// Funciones de la API
async function convertRomanToArabic(roman) {
    if (!USE_API) {
        return window.romanToArabicLocal(roman);
    }

    try {
        const response = await fetch(`${API_ENDPOINT}/to-arabic?roman=${encodeURIComponent(roman)}`);
        if (!response.ok) throw new Error('Error en la API');
        const data = await response.json();
        return data.arabic;
    } catch (error) {
        console.warn('Usando conversión local debido a error en la API');
        return window.romanToArabicLocal(roman);
    }
}

async function convertArabicToRoman(arabic) {
    if (!USE_API) {
        return window.arabicToRomanLocal(arabic);
    }

    try {
        const response = await fetch(`${API_ENDPOINT}/to-roman?number=${arabic}`);
        if (!response.ok) throw new Error('Error en la API');
        const data = await response.json();
        return data.roman;
    } catch (error) {
        console.warn('Usando conversión local debido a error en la API');
        return window.arabicToRomanLocal(arabic);
    }
}

// Registrar funciones locales como respaldo
window.romanToArabicLocal = romanToArabic;
window.arabicToRomanLocal = arabicToRoman;

// Actualizar manejadores de eventos
document.addEventListener('DOMContentLoaded', function() {
    const convertToArabicBtn = document.getElementById('convertToArabicBtn');
    const convertToRomanBtn = document.getElementById('convertToRomanBtn');
    
    if (convertToArabicBtn) {
        convertToArabicBtn.addEventListener('click', async function() {
            const romanInput = document.getElementById('romanInput');
            const resultElement = document.getElementById('result');
            
            if (!romanInput || !resultElement) return;
            
            const roman = romanInput.value.trim().toUpperCase();
            if (!roman) {
                resultElement.textContent = 'Por favor ingresa un número romano';
                return;
            }
            
            try {
                const arabic = await convertRomanToArabic(roman);
                if (arabic === null) {
                    resultElement.textContent = 'Número romano inválido';
                    return;
                }
                resultElement.textContent = `Resultado: ${arabic}`;
            } catch (error) {
                console.error('Error en la conversión:', error);
                resultElement.textContent = 'Error al convertir el número romano';
            }
        });
    }

    if (convertToRomanBtn) {
        convertToRomanBtn.addEventListener('click', async function() {
            const arabicInput = document.getElementById('arabicInput');
            const resultElement = document.getElementById('result');
            
            if (!arabicInput || !resultElement) return;
            
            const arabic = parseInt(arabicInput.value, 10);
            if (isNaN(arabic) || arabic < 1 || arabic > 3999) {
                resultElement.textContent = 'Por favor ingresa un número entre 1 y 3999';
                return;
            }
            
            try {
                const roman = await convertArabicToRoman(arabic);
                if (roman === null) {
                    resultElement.textContent = 'Error en la conversión';
                    return;
                }
                resultElement.textContent = `Resultado: ${roman}`;
            } catch (error) {
                console.error('Error en la conversión:', error);
                resultElement.textContent = 'Error al convertir el número arábigo';
            }
        });
    }
});
</script>